<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>src.score_selection.main &#8212; I-MaT 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for src.score_selection.main</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module: score_selection.main.py</span>
<span class="sd">===============================</span>

<span class="sd">This module facilitates the selection and loading of a music score for further analysis or processing.</span>

<span class="sd">The primary function in this module, `score_selection`, coordinates the process of selecting a score. The user is</span>
<span class="sd">initially offered a choice between selecting from a list of pre-defined scores or providing their own score via</span>
<span class="sd">a local file or URL. Depending on their selection, a relevant helper function is invoked to assist the user</span>
<span class="sd">through the selection process.</span>

<span class="sd">Functions</span>
<span class="sd">---------</span>
<span class="sd">- `select_score_source`: Displays a menu that allows the user to choose the source of the score.</span>
<span class="sd">- `select_example_score`: Shows a menu that lets the user select a predefined score.</span>
<span class="sd">- `load_example_score`: Loads the selected example score and provides troubleshooting tips if needed.</span>
<span class="sd">- `select_own_score`: Provides instructions to the user for entering a path or URL to their score.</span>
<span class="sd">- `load_own_score`: Starts loading the user-provided score and offers troubleshooting advice if needed.</span>

<span class="sd">Each function handles user inputs and may return a music21 stream object</span>
<span class="sd">representing the selected score or guide the user through the score selection process.</span>

<span class="sd">In case of any exceptions during the process, they are caught and redirected to the `handle_error` function for</span>
<span class="sd">suitable management and resolution.</span>

<span class="sd">Example</span>
<span class="sd">-------</span>
<span class="sd">&gt;&gt;&gt; from score_selection import main</span>
<span class="sd">&gt;&gt;&gt; score = main.load_example_score(&quot;path/to/example/score.xml&quot;)</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">This module heavily relies on the `music21` library, specifically the `music21.converter`</span>
<span class="sd">module to load musical scores from various sources and formats.</span>

<span class="sd">See Also</span>
<span class="sd">--------</span>
<span class="sd">music21.converter.parse</span>
<span class="sd">music21.stream.Stream</span>
<span class="sd">src.utils.error_handling.handle_error</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlparse</span>

<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">music21</span> <span class="kn">import</span> <span class="n">converter</span>

<span class="kn">from</span> <span class="nn">iMaT.src.cli.menu_constructors</span> <span class="kn">import</span> <span class="n">display_menu_print_textblock</span><span class="p">,</span> <span class="n">display_menu_request_selection</span>
<span class="kn">from</span> <span class="nn">iMaT.src.constants</span> <span class="kn">import</span> <span class="n">EXAMPLE_SCORES_DICT</span>
<span class="kn">from</span> <span class="nn">iMaT.src.score_selection.name_parts</span> <span class="kn">import</span> <span class="n">select_and_name_parts</span>
<span class="kn">from</span> <span class="nn">iMaT.src.utils.error_handling</span> <span class="kn">import</span> <span class="n">handle_error</span>


<div class="viewcode-block" id="score_selection"><a class="viewcode-back" href="../../../module_files/src.score_selection.html#src.score_selection.main.score_selection">[docs]</a><span class="k">def</span> <span class="nf">score_selection</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The main function that orchestrates the selection of music scores.</span>

<span class="sd">    This function guides the user through the process of selecting a music score. It first asks the user to choose a</span>
<span class="sd">    source for the music score - either from a predefined example or from their own local file or URL. The function</span>
<span class="sd">    then loads the selected score and calls the select_and_name_parts function to allow the user to name the parts of</span>
<span class="sd">    the score. If any exception occurs during this process, it is caught and passed to the handle_error function.</span>

<span class="sd">    See Also:</span>
<span class="sd">        select_score_source: Function to select a source of a music score.</span>
<span class="sd">        select_example_score: Function to select an example music score.</span>
<span class="sd">        select_own_score: Function to select a custom music score.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">select_score_source</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;example&quot;</span><span class="p">:</span>
            <span class="n">score_url</span> <span class="o">=</span> <span class="n">select_example_score</span><span class="p">()</span>
            <span class="n">selected_score</span> <span class="o">=</span> <span class="n">load_example_score</span><span class="p">(</span><span class="n">score_url</span><span class="p">)</span>
            <span class="n">select_and_name_parts</span><span class="p">(</span><span class="n">selected_score</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">source</span> <span class="o">==</span> <span class="s2">&quot;own&quot;</span><span class="p">:</span>
            <span class="n">score_url</span> <span class="o">=</span> <span class="n">select_own_score</span><span class="p">()</span>
            <span class="n">selected_score</span> <span class="o">=</span> <span class="n">load_own_score</span><span class="p">(</span><span class="n">score_url</span><span class="p">)</span>
            <span class="n">select_and_name_parts</span><span class="p">(</span><span class="n">selected_score</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Invalid input. Please try again.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;&lt;To continue, please press Enter&gt;&quot;</span><span class="p">)</span>
            <span class="n">score_selection</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="select_score_source"><a class="viewcode-back" href="../../../module_files/src.score_selection.html#src.score_selection.main.select_score_source">[docs]</a><span class="k">def</span> <span class="nf">select_score_source</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to allow the user to select an example music score.</span>

<span class="sd">    This function presents the user with a menu of available example scores. The menu entries are constructed based on</span>
<span class="sd">    the entries in the example_scores_dict dictionary. The function uses the display_menu_request_selection function</span>
<span class="sd">    to present the menu and capture the user&#39;s choice. If any exception occurs during this process, it is caught and</span>
<span class="sd">    passed to the handle_error function.</span>

<span class="sd">    See Also:</span>
<span class="sd">        display_menu_request_selection: Function to display a menu and request a selection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">source_menu</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Select Score Source&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Please select a source of music scores:&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter your choice (1 or 2): &quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;Menu item&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;Explanation&gt;&quot;</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="s2">&quot;menu_entries&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="s2">&quot;EXMP: Example sheet music file&quot;</span><span class="p">,</span> <span class="s2">&quot;example&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;&lt;Choose one entry from a list of predefined sheet music files&gt;&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;CSTM: Custom sheet music file&quot;</span><span class="p">,</span> <span class="s2">&quot;own&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;&lt;Select your own sheet music file by entering a local path or an URL&gt;&quot;</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">display_menu_request_selection</span><span class="p">(</span><span class="n">source_menu</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="select_example_score"><a class="viewcode-back" href="../../../module_files/src.score_selection.html#src.score_selection.main.select_example_score">[docs]</a><span class="k">def</span> <span class="nf">select_example_score</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to allow the user to select their own music score.</span>

<span class="sd">    This function presents the user with guidelines for inputting the path or URL to their own score. The function</span>
<span class="sd">    uses the display_menu_print_textblock function to present the guidelines and capture the user&#39;s input. If any</span>
<span class="sd">    exception occurs during this process, it is caught and passed to the handle_error function.</span>

<span class="sd">    See Also:</span>
<span class="sd">        display_menu_print_textblock: Function to display a text block and request user input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">score_menu</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Select Example Score&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Please select an example score:&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter your choice (1-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">EXAMPLE_SCORES_DICT</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;): &quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;Score Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Source/Database&quot;</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="s2">&quot;menu_entries&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">value</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">EXAMPLE_SCORES_DICT</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">],</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">display_menu_request_selection</span><span class="p">(</span><span class="n">score_menu</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_example_score"><a class="viewcode-back" href="../../../module_files/src.score_selection.html#src.score_selection.main.load_example_score">[docs]</a><span class="k">def</span> <span class="nf">load_example_score</span><span class="p">(</span><span class="n">score_url</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to load an example music score.</span>

<span class="sd">    This function takes as input a URL to an example music score. It first attempts to access the URL, providing</span>
<span class="sd">    troubleshooting guidance to the user if this fails. If the URL is successfully accessed, the function then</span>
<span class="sd">    attempts to parse the score, again providing troubleshooting guidance if this fails. If the score is successfully</span>
<span class="sd">    parsed and contains at least one part, it is returned. Otherwise, the user is prompted to select another score.</span>

<span class="sd">    See Also:</span>
<span class="sd">        display_menu_print_textblock: Function to display a text block and request user input.</span>
<span class="sd">        score_selection: Main function to orchestrate the selection of music scores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">score_url</span><span class="p">)</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
        <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The score could not be accessed.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Press Enter to try again: &quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Troubleshooting assistance:&quot;</span><span class="p">]</span>
            <span class="p">],</span>
            <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="s2">&quot;Possible reasons:&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;1. The URL provided may be incorrect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="s2">&quot;2. Your Internet connection might be down.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="s2">&quot;3. The &#39;autoDownload&#39; setting in the music21 environment file might be set to &#39;no&#39;, which prevents &quot;</span>
                 <span class="s2">&quot;music21 from accessing files from the web.&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;Suggestion:&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;1. Check the URL you&#39;ve provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="s2">&quot;2. Check your Internet connection.</span><span class="se">\n</span><span class="s2">&quot;</span>
                 <span class="s2">&quot;3. Change the &#39;autoDownload&#39; setting in the music21 environment file to &#39;yes&#39;.&quot;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
        <span class="n">score_selection</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">score_url</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">score</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">score</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;The score does not contain any parts.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Press Enter to try again: &quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Troubleshooting assistance:&quot;</span><span class="p">]</span>
                <span class="p">],</span>
                <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">[</span><span class="s2">&quot;Possible reasons:&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;The example score selected may not contain any identifiable parts.&quot;</span><span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;Suggestion:&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Please try another example score. The scores should have been vetted for content, but there may &quot;</span>
                     <span class="s2">&quot;have been an error.&quot;</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">}</span>
            <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
            <span class="n">score_selection</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                <span class="s2">&quot;The score could not be parsed.&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Press Enter to try again: &quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Troubleshooting assistance:&quot;</span><span class="p">]</span>
            <span class="p">],</span>
            <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="s2">&quot;Possible reasons:&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;There might be an issue with the format or content of the selected example score. It could be &quot;</span>
                 <span class="s2">&quot;corrupted or in an incompatible format.&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;Suggestion:&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Please try selecting another example score. If the issue persists with multiple scores, there may &quot;</span>
                 <span class="s2">&quot;be a problem with the parser.&quot;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
        <span class="n">score_selection</span><span class="p">()</span></div>


<span class="c1"># noinspection HttpUrlsUsage</span>
<div class="viewcode-block" id="select_own_score"><a class="viewcode-back" href="../../../module_files/src.score_selection.html#src.score_selection.main.select_own_score">[docs]</a><span class="k">def</span> <span class="nf">select_own_score</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to allow the user to select their own music score.</span>

<span class="sd">    This function presents the user with guidelines for inputting the path or URL to their own score. The function</span>
<span class="sd">    uses the display_menu_print_textblock function to present the guidelines and capture the user&#39;s input. If any</span>
<span class="sd">    exception occurs during this process, it is caught and passed to the handle_error function.</span>

<span class="sd">    See Also:</span>
<span class="sd">        display_menu_print_textblock: Function to display a text block and request user input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;Select Your Own Score&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Please provide the path to your own score or a URL. Here are some guidelines:&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Enter the path or URL: &quot;</span><span class="p">,</span>
                <span class="p">[</span><span class="s2">&quot;Hints&quot;</span><span class="p">,</span> <span class="s2">&quot;Guidelines&quot;</span><span class="p">],</span>
            <span class="p">],</span>
            <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">[</span><span class="s2">&quot;File format&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;Music21 can parse a variety of file formats including MIDI (.mid, .midi), MusicXML (.xml, .musicxml), &quot;</span>
                 <span class="s2">&quot;ABC (.abc), and more. Please make sure your file is in a supported format.&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;Path format&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;The path to your file should be a string. If the path includes spaces, make sure to surround it with &quot;</span>
                 <span class="s2">&quot;quotes. For example: &#39;/Users/username/Documents/My Music/my_file.mid&#39;&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;URL&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;You can also provide a URL to a file. Ensure that the URL ends with the file extension, &quot;</span>
                 <span class="s2">&quot;like &#39;http://example.com/my_file.mid&#39;. Not all websites allow direct access to files, so this method &quot;</span>
                 <span class="s2">&quot;may not always work.&quot;</span><span class="p">],</span>
                <span class="p">[</span><span class="s2">&quot;Drag and drop&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;You can drag and drop the file into the console. The path will be automatically populated. Note: This &quot;</span>
                 <span class="s2">&quot;method does not work for URLs.&quot;</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">}</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">path</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="load_own_score"><a class="viewcode-back" href="../../../module_files/src.score_selection.html#src.score_selection.main.load_own_score">[docs]</a><span class="k">def</span> <span class="nf">load_own_score</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to load a user-provided music score.</span>

<span class="sd">    This function takes as input a path or URL to a music score. It first checks whether the input is a URL. If it is,</span>
<span class="sd">    the function attempts to access the URL, providing troubleshooting guidance to the user if this fails. If the input</span>
<span class="sd">    is not a URL, the function checks whether it corresponds to a valid local file path, again providing</span>
<span class="sd">    troubleshooting guidance if this fails. If the score file is successfully accessed, the function then attempts to</span>
<span class="sd">    parse the score, providing troubleshooting guidance if this fails. If the score is successfully parsed and contains</span>
<span class="sd">    at least one part, it is returned. Otherwise, the user is prompted to select another score.</span>

<span class="sd">    See Also:</span>
<span class="sd">        display_menu_print_textblock: Function to display a text block and request user input.</span>
<span class="sd">        score_selection: Main function to orchestrate the selection of music scores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Check if the given path is a URL</span>
        <span class="n">parsed</span> <span class="o">=</span> <span class="n">urlparse</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
        <span class="n">is_url</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">parsed</span><span class="o">.</span><span class="n">netloc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">is_url</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
                <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
            <span class="k">except</span> <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;The score could not be accessed.&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Press Enter to try again: &quot;</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Troubleshooting assistance:&quot;</span><span class="p">]</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">[</span><span class="s2">&quot;Possible reasons:&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;1. The URL provided may be incorrect.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;2. Your Internet connection might be down.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;3. The &#39;autoDownload&#39; setting in the music21 environment file might be set to &#39;no&#39;, &quot;</span>
                         <span class="s2">&quot;which prevents music21 from accessing files from the web.&quot;</span><span class="p">],</span>
                        <span class="p">[</span><span class="s2">&quot;Suggestion:&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;1. Check the URL you&#39;ve provided.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;2. Check your Internet connection.</span><span class="se">\n</span><span class="s2">&quot;</span>
                         <span class="s2">&quot;3. Change the &#39;autoDownload&#39; setting in the music21 environment file to &#39;yes&#39;.&quot;</span><span class="p">]</span>
                    <span class="p">]</span>
                <span class="p">}</span>
                <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
                <span class="n">score_selection</span><span class="p">()</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
                <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;The file does not exist.&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Press Enter to try again: &quot;</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Troubleshooting assistance:&quot;</span><span class="p">]</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">[</span><span class="s2">&quot;Possible reasons:&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;The file path or URL you&#39;ve provided may not be valid, or the file may have been moved or &quot;</span>
                         <span class="s2">&quot;deleted.&quot;</span><span class="p">],</span>
                        <span class="p">[</span><span class="s2">&quot;Suggestion:&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Check that you&#39;ve entered the file path or URL correctly. If you&#39;re using a file path, &quot;</span>
                         <span class="s2">&quot;it should be absolute (including the full path from the root directory) and correctly formatted &quot;</span>
                         <span class="s2">&quot;for your operating system. If you&#39;re using a URL, ensure it is accessible.&quot;</span><span class="p">]</span>
                    <span class="p">]</span>
                <span class="p">}</span>
                <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
                <span class="n">score_selection</span><span class="p">()</span>
                <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">score</span><span class="o">.</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">score</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;The score does not contain any parts.&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Press Enter to try again: &quot;</span><span class="p">,</span>
                        <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Troubleshooting assistance:&quot;</span><span class="p">]</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">[</span><span class="s2">&quot;Possible reasons:&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;The file you&#39;re providing may not contain a musical score, or it does not contain any &quot;</span>
                         <span class="s2">&quot;identifiable parts.&quot;</span><span class="p">],</span>
                        <span class="p">[</span><span class="s2">&quot;Suggestion:&quot;</span><span class="p">,</span>
                         <span class="s2">&quot;Please ensure the file is a valid musical score with at least one part, such as a melody or &quot;</span>
                         <span class="s2">&quot;harmony line.&quot;</span><span class="p">]</span>
                    <span class="p">]</span>
                <span class="p">}</span>
                <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
                <span class="n">score_selection</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">text_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;menu_displayed_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;Error&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;The score could not be parsed.&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;Press Enter to continue: &quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Troubleshooting assistance:&quot;</span><span class="p">]</span>
                <span class="p">],</span>
                <span class="s2">&quot;menu_entries_text&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">[</span><span class="s2">&quot;Possible reasons:&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;There might be an issue with the file format or the content of the file. The file may not be in a &quot;</span>
                     <span class="s2">&quot;format that music21 can parse, or it could be corrupted.&quot;</span><span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;Suggestion:&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Try using a different file or converting your file to a different format. The file formats &quot;</span>
                     <span class="s2">&quot;supported by music21 include MIDI (.mid), MusicXML (.xml), ABC (.abc), and others.&quot;</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">}</span>
            <span class="n">display_menu_print_textblock</span><span class="p">(</span><span class="n">text_dict</span><span class="p">)</span>
            <span class="n">score_selection</span><span class="p">()</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">I-MaT</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting Started with I-MaT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute.html">How to Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../module_files/src.html">I-MaT: Source Code</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Sebastian Oliver Eck.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
    </div>

    

    
  </body>
</html>